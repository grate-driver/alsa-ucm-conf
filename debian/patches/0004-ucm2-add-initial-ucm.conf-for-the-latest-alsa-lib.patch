From e4f3a366fcff6703948017b6e3335a6a23744f46 Mon Sep 17 00:00:00 2001
From: Jaroslav Kysela <perex@perex.cz>
Date: Wed, 27 May 2020 12:28:32 +0200
Subject: [PATCH 04/14] ucm2: add initial ucm.conf for the latest alsa-lib

Signed-off-by: Jaroslav Kysela <perex@perex.cz>
(cherry picked from commit 24ac1523e51469bdfa2ebb5f5dbec35743935403)
Signed-off-by: Hui Wang <hui.wang@canonical.com>
---
 ucm2/ucm.conf | 93 +++++++++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 93 insertions(+)
 create mode 100644 ucm2/ucm.conf

diff --git a/ucm2/ucm.conf b/ucm2/ucm.conf
new file mode 100644
index 0000000..29bef5c
--- /dev/null
+++ b/ucm2/ucm.conf
@@ -0,0 +1,93 @@
+#
+# This is the toplevel file included from the alsa-lib.
+#
+# It allows to add extra lookups for the old kernels or so.
+#
+# You may specify the directory (relative to the toplevel) and
+# the master configuration file which defines the verbs.
+#
+
+#
+# Syntax version is reset for the master configuration file.
+#
+
+Syntax 3
+
+If.driver {
+	Condition {
+		Type String
+		Empty "${CardNumber}"
+	}
+	True {
+
+		#
+		# The last probed path for no-hw-card:
+		#
+		#   ucm2/${OpenName}/${OpenName}.conf
+		#   ucm/${OpenName}/${OpenName}.conf
+		#
+
+		UseCasePath {
+			legacy {
+				Directory "${OpenName}"
+				File "${OpenName}.conf"
+			}
+			v1_legacy {
+				Version 1
+				Directory "${OpenName}"
+				File "${OpenName}.conf"
+			}
+		}
+
+	}
+	False {
+
+		#
+		# The last probed path when hw-card is found:
+		#
+		#   ucm2/${CardDriver}/${CardLongName}.conf
+		#   ucm2/${CardDriver}/${CardDriver}.conf
+		#   ucm/${CardLongName}/${CardLongName}.conf
+		#   ucm/${CardName}/${CardName}.conf or \
+		#			ucm/${OpenName}/${OpenName}.conf
+		#
+
+		UseCasePath {
+			longname {
+				Directory "${CardDriver}"
+				File "${CardLongName}.conf"
+			}
+			driver {
+				Directory "${CardDriver}"
+				File "${CardDriver}.conf"
+			}
+			v1_longname {
+				Version 1
+				Directory "${CardLongName}"
+				File "${CardLongName}.conf"
+			}
+		}
+
+		If.hw {
+			Condition {
+				Type String
+				Haystack "${OpenName}.conf"
+				Needle "hw:"
+			}
+			True {
+				UseCasePath.v1_cardnamme {
+					Version 1
+					Directory "${CardName}"
+					File "${CardName}.conf"
+				}
+			}
+			False {
+				UseCasePath.v1_openname {
+					Version 1
+					Directory "${OpenName}"
+					File "${OpenName}.conf"
+				}
+			}
+		}
+	}
+}
-- 
2.17.1

